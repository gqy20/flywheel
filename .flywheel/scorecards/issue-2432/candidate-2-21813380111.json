{
  "issue_number": 2432,
  "candidate_number": 2,
  "run_id": "21813380111",
  "status": "implemented",
  "stage": "finalize",
  "title": "[Enhancement] 添加存储路径配置的默认值层级（环境变量 > XDG > 当前目录）",
  "branch_name": "claude/issue-2432-candidate-2-21813380111",
  "plan": {
    "description": "Implement path resolution priority: TODO_DB_PATH env var > XDG_DATA_HOME > current directory .todo.json",
    "files_to_touch": [
      "src/flywheel/storage.py",
      "tests/test_issue_2432_path_resolution.py"
    ],
    "test_plan": [
      "test_default_path_when_no_env_vars_set",
      "test_xdg_data_home_path_when_set",
      "test_todo_db_path_takes_priority_over_xdg",
      "test_xdg_path_directory_auto_created",
      "test_explicit_path_overrides_all_defaults"
    ],
    "implementation_sequence": [
      "1. Add _resolve_default_path() helper function to storage.py",
      "2. Update TodoStorage.__init__ to use the new path resolver",
      "3. Handle XDG path: ~/.local/share/todo/todo.json",
      "4. Add unittest.mock monkeypatch_environment() helper for tests"
    ],
    "verification_commands": [
      "uv run pytest tests/test_issue_2432_path_resolution.py -v",
      "uv run ruff check src/flywheel/storage.py",
      "uv run pytest tests/ -k storage -v"
    ]
  },
  "test_results": {
    "total_tests": 8,
    "passed": 8,
    "failed": 0,
    "coverage": "67% for storage.py",
    "test_names": [
      "test_default_path_when_no_env_vars_set",
      "test_xdg_data_home_path_when_set",
      "test_xdg_fallback_to_home_local_share",
      "test_todo_db_path_takes_priority_over_xdg",
      "test_explicit_path_overrides_all_defaults",
      "test_xdg_path_directory_auto_created",
      "test_path_resolution_priority_order",
      "test_home_local_share_directory_auto_created"
    ]
  },
  "pr_url": null,
  "acceptance_criteria_met": {
    "todo_db_path_priority": true,
    "xdg_data_home_fallback": true,
    "home_fallback": true,
    "current_directory_fallback": true,
    "directory_auto_creation": true,
    "unit_tests_added": true
  },
  "implementation_details": {
    "function": "_resolve_default_path()",
    "priority_order": [
      "TODO_DB_PATH",
      "XDG_DATA_HOME",
      "HOME/.local/share",
      "Path.cwd()/.todo.json"
    ]
  }
}
